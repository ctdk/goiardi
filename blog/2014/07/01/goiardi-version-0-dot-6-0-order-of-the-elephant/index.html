
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Goiardi Version 0.6.0 - Order of the Elephant - Goiardi</title>
  <meta name="author" content="Jeremy Bingham">

  
  <meta name="description" content="The Order of the Elephant is a Danish order awarded mostly to foreign heads of state and royals. Its elephant-themed insignia is appropriate for &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://ctdk.github.io/goiardi/blog/2014/07/01/goiardi-version-0-dot-6-0-order-of-the-elephant">
  <link href="/goiardi/favicon.png" rel="icon">
  <link href="/goiardi/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/goiardi/atom.xml" rel="alternate" title="Goiardi" type="application/atom+xml">
  <script src="/goiardi/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/goiardi/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='http://fonts.googleapis.com/css?family=Istok+Web' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-6397614-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/goiardi/">Goiardi</a></h1>
  
    <h2>The one-eyed fanged yak is becoming on you.</h2>
  
  </div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/goiardi/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:ctdk.github.io/goiardi" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/goiardi/">Blog</a></li>
  <li><a href="/goiardi/blog/archives">Archives</a></li>
  <li><a href="/goiardi/docs">Documentation</a></li>
  <li><a href="https://github.com/ctdk/goiardi">Source</a></li>
  <li><a href="http://time.to.pullthepl.ug">Time To Pull The Plug</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Goiardi Version 0.6.0 - Order of the Elephant</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-07-01T21:36:11-07:00" pubdate data-updated="true">Jul 1<span>st</span>, 2014</time>
        
      </p>
    
  </header>


<div class="entry-content"><div style="margin-left: auto; margin-right: auto; width: 40%;"><img src="/goiardi/images/Order_of_the_Elephant_12.jpg" /></div>


<p>The <a href="http://en.wikipedia.org/wiki/Order_of_the_Elephant">Order of the Elephant</a> is a Danish order awarded mostly to foreign heads of state and royals. Its elephant-themed insignia is appropriate for this latest release of goiardi, <a href="https://github.com/ctdk/goiardi/releases/tag/v0.6.0">version 0.6.0</a>.</p>

<p>Along with some bug fixes and smaller improvements, this release introduces Postgres as a supported database backend. The schema is not compatible with erchef&rsquo;s schema, but is close to the goiardi MySQL schema (with some differences of course). This is the first project I&rsquo;ve done with Postgres, so comments on how goiardi is using it are welcome.</p>

<p>Full CHANGELOG:</p>

<ul>
<li>Postgres support.</li>
<li>Fix rebuilding indexes with an SQL backend.</li>
<li>Fix a bug where in MySQL mode events were being logged twice.</li>
<li>Fix an annoying chef-pedant error with data bags.</li>
<li>Event logging methods that are not allowed now return Method Not Allowed
rather than Bad Request.</li>
<li>Switch the logger to a fork that can be built and used with Windows that
excludes syslog when building on Windows.</li>
<li>Add basic syslog support.</li>
<li>Authentication protocol version 1.2 now supported.</li>
<li>Add a &lsquo;status&rsquo; param to reporting, so a list of reports return by &lsquo;knife
runs&rsquo; can be narrowed by the status of the chef run (started, success, and
failure).</li>
<li>Fix an action at a distance problem with in-memory mode objects. If this
behavior is still desirable (it seems to be slightly faster than the new way),
it can be turned back on with the &mdash;use-unsafe-mem-store flag. This change
DEFINITELY breaks in-mem data file compatibility. If upgrading, export your
data, upgrade goiardi, and reload your data.</li>
<li>Add several new searchable parameters for logged events.</li>
<li>Add organization_id to all MySQL tables that might need it someday. Orgs are
not used at all, so only the default value of 1 currently makes it to the
database.</li>
<li>Finally ran &lsquo;go fmt&rsquo; on goiardi. It didn&rsquo;t even mess up the long comment
blocks, which was what I was afraid it would do. I also ran golint against
goiardi and took its recommendations where it made sense, which was most
areas except for some involving generated parser code, comments on
GobEncode/Decode, commenting a bunch of identical functions on an interface
in search, and a couple of cases involving make and slices. All in all,
though, the reformatting, linting, and light refactoring has done it good.</li>
</ul>


<p>To reiterate, this update breaks saved data file compatibility. You&rsquo;ll need to export and re-import your data if you&rsquo;re using the persistent in-memory data store.</p>

<p>A selection of precompiled binaries are provided on the release page, including Windows and Solaris builds. There are also knife plugins for goiardi&rsquo;s reporting and event logging capabilities at <a href="https://github.com/ctdk/knife-goiardi-reporting">knife-goiardi-reporting</a> and <a href="https://github.com/ctdk/knife-goiardi-event-log">knife-goiardi-event-log</a>. The reporting plugin was forked from the official Chef knife-reporting plugin to add support for the &ldquo;status&rdquo; parameter. Both plugins are also available on rubygems.</p>

<p>Finally, after someone asked how goiardi would handle running ~500 nodes, I decided to take a look and see. I <a href="https://gist.github.com/ctdk/a2d40f03ddfc616e0d42">whipped up a little test script</a> to create a thousand nodes and clients to see how goiardi (and more importantly the search) would handle it. I wasn&rsquo;t particularly worried about the non-search portions of goiardi (1000 rows on a table isn&rsquo;t very much at all, after all), but I hadn&rsquo;t tested search extensively with large amounts of data. After creating those 1,000 nodes and clients, goiardi was using about 1.40 GB of RAM. An earlier test with 5,500 nodes (but no clients) used 6.45GB RAM. The numbers show that there&rsquo;s definitely room for improvement with the search, in that the capability for indexing nodes and data bags is limited by RAM, but performance was good even at 5,500 nodes. More rigorous testing is needed, however. Search is an area I intend to revisit shortly to improve these problems.</p>

<p>The next issues to work on with goiardi are currently improving search to work even better with large amounts of data and use raft (or something similar) to allow multiple goiardi instances to keep their search indexes consistent, reworking the permissions system, being able to upload files to s3 or similar storage providers, and the serf based pushy type thing.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Jeremy Bingham</span></span>

      








  


<time datetime="2014-07-01T21:36:11-07:00" pubdate data-updated="true">Jul 1<span>st</span>, 2014</time>
      

<span class="categories">
  
    <a class='category' href='/goiardi/blog/categories/goiardi/'>goiardi</a>, <a class='category' href='/goiardi/blog/categories/postgres/'>postgres</a>, <a class='category' href='/goiardi/blog/categories/releases/'>releases</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/goiardi/blog/2014/06/19/building-goiardi-on-solaris-slash-illumos-slash-etc/" title="Previous Post: Building goiardi on Solaris/illumos/etc.">&laquo; Building goiardi on Solaris/illumos/etc.</a>
      
      
        <a class="basic-alignment right" href="/goiardi/blog/2014/07/21/goiardi-version-0-dot-7-0-orphans-of-the-sky/" title="Next Post: goiardi version 0.7.0 - Orphans of the Sky">goiardi version 0.7.0 - Orphans of the Sky &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>About Goiardi</h1>
  <p><a href="https://github.com/ctdk/goiardi">Goiardi</a> is an implementation of <a href="http://www.getchef.com/chef/">the Chef server</a> written in <a href="http://golang.org">Go</a>. It can run entirely in memory (with optional persistence on disk) or can use MySQL or Postgres as a backend, is self-contained, and runs on many different platforms.</p>
</section>
<section>
  <h1>Additional Resources</h1>
   <ul>
    <li><a href="https://github.com/ctdk/goiardi-schema">goiardi-schema</a>: The SQL schema, managed with sqitch, for goiardi.</li>
    <li><a href="https://github.com/marpaia/chef-golang">chef-golang</a>: A golang chef client library.</li>
    <li><a href="https://github.com/go-chef">go-chef</a>: A number of chef libs and utilities written in Go.</li>
    <li><a href="http://docs.opscode.com/">docs.opscode.com</a>: The official Chef documentation. The chef client programs are, of course, needed to do much of anything with goiardi.</li>
    <li><a href="https://github.com/opscode/chef-zero">chef-zero</a>: Another in-memory chef server.</li>
    <li><a href="https://github.com/opscode/erchef">erchef</a>: The official Chef server, written in Erlang.</li>
    <li><a href="https://github.com/opscode/omnibus-chef-server">omnibus-chef-server</a>: Omnibus installer for erchef.</li>
    <li><a href="https://github.com/ctdk/knife-goiardi-event-log">knife-goiardi-event-log</a>: Knife plugin for the goiardi event log.</li>
    <li><a href="https://github.com/ctdk/knife-goiardi-reporting">knife-goiardi-reporting</a>: Forked knife plugin for goiardi's reporting facilities.</li>
    <li><a href="https://github.com/ctdk/schob">schob</a>: The goiardi shovey client.</li>
    <li><a href="https://github.com/ctdk/knife-shove">knife-shove</a>: Knife plugin forked from knife-push for managing shovey jobs.</li>
    <li><a href="https://github.com/ctdk/shovey-jobs">shovey-jobs</a>: chef cookbook for installing and configuring shovey on a node. In-progress.</li>
   </ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/goiardi/blog/2014/11/23/goiardi-version-0-dot-8-2-can-shaped-cranberry-sauce/">Goiardi Version 0.8.2 - Can-shaped Cranberry Sauce</a>
      </li>
    
      <li class="post">
        <a href="/goiardi/blog/2014/10/15/goiardi-version-0-dot-8-1-and-schob-version-0-dot-1-1-hand-of-ishtar-hand-of-nergal/">Goiardi Version 0.8.1 and Schob Version 0.1.1 - Hand of Ishtar, Hand of Nergal</a>
      </li>
    
      <li class="post">
        <a href="/goiardi/blog/2014/09/29/goiardi-version-0-dot-8-0-plus-shovey-hojotoho-hojotoho/">Goiardi Version 0.8.0 (Plus Shovey) - Hojotoho! Hojotoho!</a>
      </li>
    
      <li class="post">
        <a href="/goiardi/blog/2014/09/24/goiardi-plus-shovey-in-final-prerelease-stage/">Goiardi + Shovey in Final Prerelease Stage</a>
      </li>
    
      <li class="post">
        <a href="/goiardi/blog/2014/09/05/another-shovey-preview-the-shovey-jobs-cookbook/">Another Shovey Preview: The Shovey-Jobs Cookbook</a>
      </li>
    
  </ul>
</section>




<a class="twitter-timeline" href="https://twitter.com/goiardi" data-widget-id="421775961479057409">Tweets by @goiardi</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Jeremy Bingham -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span><br />
  <a rel="license" href="http://creativecommons.org/licenses/by/3.0/us/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by/3.0/us/80x15.png" /></a> Unless otherwise specified, all content on this site is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/3.0/us/">Creative Commons Attribution 3.0 United States License</a>.<br />
  <a href="http://www.getchef.com">Chef</a> is &copy; 2008-2014, Chef (ne√© Opscode).
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'goiardi';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://ctdk.github.io/goiardi/blog/2014/07/01/goiardi-version-0-dot-6-0-order-of-the-elephant/';
        var disqus_url = 'http://ctdk.github.io/goiardi/blog/2014/07/01/goiardi-version-0-dot-6-0-order-of-the-elephant/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
